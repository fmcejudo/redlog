common_query: ''

queries:
  - id: audalapi
    description: AUDALAPI
    type: COUNT
    query: |
      sum by (short_message)(count_over_time(
        {stream_filter="AUDALAPI", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
         | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))

  - id: mecaudal
    description: MECAUDAL
    type: COUNT
    query: |
      sum by (short_message)(count_over_time(
        {stream_filter="MECAUDAL", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        !~ `flush to prometheus has failed after (.*) retries`
        !~ `ConnectException: Connection refused`
        !~ `SocketTimeoutException: connect timed out`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))

  - id: mecaudal_flush_prometheus
    description: MECAUDAL Flush Prometheus
    type: COUNT
    query: |
      sum by (short_message)(count_over_time(
        {stream_filter="MECAUDAL", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        |~ `flush to prometheus has failed after (.*) retries`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))

  - id: mecaudal_connection_refused
    description: MECAUDAL Connection Refused
    type: COUNT
    query: |
      sum by (loggerName)(count_over_time(
        {stream_filter="MECAUDAL", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        |~ `ConnectException: Connection refused`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))

  - id: mecaudal_socket_timeout
    description: MECAUDAL Socket Timeout
    type: COUNT
    query: |
      sum by (loggerName)(count_over_time(
        {stream_filter="MECAUDAL", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        |~ `SocketTimeoutException: connect timed out`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))

  - id: mecauden_number_format
    description: MECAUDEN Number Format Exception
    type: COUNT
    query: |
      sum by (loggerName)(count_over_time(
        {stream_filter="MECAUDEN", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        |~ `java.lang.NumberFormatException: For input string:`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))

  - id: mecauden_null_value
    description: MECAUDEN Null Value
    type: COUNT
    query: |
      sum by (loggerName)(count_over_time(
        {stream_filter="MECAUDEN", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        |~ `Cannot get property (.*) on null object`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))


  - id: mecaudlg_persistence_error
    description: MECAUDLG Persistence issues
    type: COUNT
    query: |
      sum by (short_message)(count_over_time(
        {stream_filter="MECAUDLG", level="ERROR", platformid="meccanointerxion2", slot="default", environment="pro"}
        |~ `Persistence template processing - Exception persisting message`
        | json | line_format `- {{.level}} - {{.short_message}}`[24h]
      ))